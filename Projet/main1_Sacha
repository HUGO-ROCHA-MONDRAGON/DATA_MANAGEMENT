{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Requirement already satisfied: pandas in /home/codespace/.local/lib/python3.12/site-packages (from -r requirement.txt (line 1)) (2.2.3)\n",
      "Requirement already satisfied: yfinance in /usr/local/python/3.12.1/lib/python3.12/site-packages (from -r requirement.txt (line 2)) (0.2.55)\n",
      "Requirement already satisfied: faker in /usr/local/python/3.12.1/lib/python3.12/site-packages (from -r requirement.txt (line 3)) (37.1.0)\n",
      "Requirement already satisfied: scipy in /home/codespace/.local/lib/python3.12/site-packages (from -r requirement.txt (line 4)) (1.15.2)\n",
      "Requirement already satisfied: schedule in /usr/local/python/3.12.1/lib/python3.12/site-packages (from -r requirement.txt (line 5)) (1.2.2)\n",
      "Requirement already satisfied: numpy>=1.26.0 in /home/codespace/.local/lib/python3.12/site-packages (from pandas->-r requirement.txt (line 1)) (2.2.4)\n",
      "Requirement already satisfied: python-dateutil>=2.8.2 in /home/codespace/.local/lib/python3.12/site-packages (from pandas->-r requirement.txt (line 1)) (2.9.0.post0)\n",
      "Requirement already satisfied: pytz>=2020.1 in /home/codespace/.local/lib/python3.12/site-packages (from pandas->-r requirement.txt (line 1)) (2025.1)\n",
      "Requirement already satisfied: tzdata>=2022.7 in /home/codespace/.local/lib/python3.12/site-packages (from pandas->-r requirement.txt (line 1)) (2025.1)\n",
      "Requirement already satisfied: requests>=2.31 in /home/codespace/.local/lib/python3.12/site-packages (from yfinance->-r requirement.txt (line 2)) (2.32.3)\n",
      "Requirement already satisfied: multitasking>=0.0.7 in /usr/local/python/3.12.1/lib/python3.12/site-packages (from yfinance->-r requirement.txt (line 2)) (0.0.11)\n",
      "Requirement already satisfied: platformdirs>=2.0.0 in /home/codespace/.local/lib/python3.12/site-packages (from yfinance->-r requirement.txt (line 2)) (4.3.6)\n",
      "Requirement already satisfied: frozendict>=2.3.4 in /usr/local/python/3.12.1/lib/python3.12/site-packages (from yfinance->-r requirement.txt (line 2)) (2.4.6)\n",
      "Requirement already satisfied: peewee>=3.16.2 in /usr/local/python/3.12.1/lib/python3.12/site-packages (from yfinance->-r requirement.txt (line 2)) (3.17.9)\n",
      "Requirement already satisfied: beautifulsoup4>=4.11.1 in /home/codespace/.local/lib/python3.12/site-packages (from yfinance->-r requirement.txt (line 2)) (4.13.3)\n",
      "Requirement already satisfied: soupsieve>1.2 in /home/codespace/.local/lib/python3.12/site-packages (from beautifulsoup4>=4.11.1->yfinance->-r requirement.txt (line 2)) (2.6)\n",
      "Requirement already satisfied: typing-extensions>=4.0.0 in /home/codespace/.local/lib/python3.12/site-packages (from beautifulsoup4>=4.11.1->yfinance->-r requirement.txt (line 2)) (4.12.2)\n",
      "Requirement already satisfied: six>=1.5 in /home/codespace/.local/lib/python3.12/site-packages (from python-dateutil>=2.8.2->pandas->-r requirement.txt (line 1)) (1.17.0)\n",
      "Requirement already satisfied: charset-normalizer<4,>=2 in /home/codespace/.local/lib/python3.12/site-packages (from requests>=2.31->yfinance->-r requirement.txt (line 2)) (3.4.1)\n",
      "Requirement already satisfied: idna<4,>=2.5 in /home/codespace/.local/lib/python3.12/site-packages (from requests>=2.31->yfinance->-r requirement.txt (line 2)) (3.10)\n",
      "Requirement already satisfied: urllib3<3,>=1.21.1 in /home/codespace/.local/lib/python3.12/site-packages (from requests>=2.31->yfinance->-r requirement.txt (line 2)) (2.3.0)\n",
      "Requirement already satisfied: certifi>=2017.4.17 in /home/codespace/.local/lib/python3.12/site-packages (from requests>=2.31->yfinance->-r requirement.txt (line 2)) (2025.1.31)\n",
      "Note: you may need to restart the kernel to use updated packages.\n"
     ]
    }
   ],
   "source": [
    "pip install -r \"requirement.txt\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "import sqlite3\n",
    "import pandas as pd\n",
    "db_file = \"Fund.db\"\n",
    "tickers = ['AAPL','MSFT', 'GOOGL', 'AMZN', 'META', 'TSLA', 'NVDA', 'PYPL', 'ADBE', 'INTC',\"BND\", \"AGG\", \"TLT\", \"GLD\", \"JNJ\", \"KO\", \"PG\"]#tickers contenus dans MAIN_DATA_FRAME\n",
    "\n",
    "start_date = \"01/09/2022\"#toute la periode start date (pour tout telecharger dun coup) + 3 mois avant\n",
    "end_date = \"31/12/2024\"#pareil"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 1. Creation et peuplement de la base"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "from base_builder import DatabaseBuilder"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Tables created successfully.\n",
      "12 clients insérés avec succès dans la table 'Clients'.\n",
      "3 managers insérés avec succès dans la table 'Managers'.\n"
     ]
    }
   ],
   "source": [
    "db_manager = DatabaseBuilder(db_file)\n",
    "db_manager.create_tables()\n",
    "db_manager.insert_clients_data(12)\n",
    "db_manager.insert_managers_data(3)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "Résumé des investissements par risk type:\n",
      "--------------------------------------------------\n",
      "Risk Type: HY_EQUITY\n",
      "Nombre de clients: 2\n",
      "Montant total investi: 9,342,908.41 €\n",
      "--------------------------------------------------\n",
      "Risk Type: LOW_RISK\n",
      "Nombre de clients: 2\n",
      "Montant total investi: 8,393,308.92 €\n",
      "--------------------------------------------------\n",
      "Risk Type: LOW_TURNOVER\n",
      "Nombre de clients: 8\n",
      "Montant total investi: 24,493,819.85 €\n",
      "--------------------------------------------------\n",
      "Montants initiaux en cash insérés avec succès dans la table Portfolios.\n"
     ]
    }
   ],
   "source": [
    "db_manager.get_investment_amount_by_risk_type()\n",
    "db_manager.insert_initial_cash_portfolios(start_date)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 2. Collecte et traitement des datas"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [],
   "source": [
    "from data_collector import GetData"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[*********************100%***********************]  1 of 1 completed\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "[*********************100%***********************]  1 of 1 completed\n"
     ]
    }
   ],
   "source": [
    "gdata = GetData(tickers, start_date, end_date)\n",
    "main_df =gdata.main_data_frame()  "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# 3. Periode avant t = 0 (Periode de \"test\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "On peuple Products avec des trois mois de donnees avant la periode d'evaluation du fonds (qui commence le 01/01/2023)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "from base_update import * \n",
    "sub_start_date = \"01/09/2022\"#chaque semaine, les strat lancent la fct et definissent les sub périodes\n",
    "#de cette maniere, products ne contient que la data jusqu'à la date t (no forward looking sur nos strats)\n",
    "sub_end_date = \"29/12/2022\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Successfully inserted 1411 new records into Products table for the period 01/09/2022 to 29/12/2022\n"
     ]
    }
   ],
   "source": [
    "B_udt = BaseUpdate(tickers, sub_start_date, sub_end_date, db_file, main_df)\n",
    "B_udt.update_products()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Initialisation des portefeuilles en fonction du cash initial"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Pour la strategie HY equity, on prend les 5 tickers les plus performants de la periode (allant du 01/09/2022 au 30/12/2022)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Cash disponible : 9,342,908.41\n",
      "\n",
      "Tickers sélectionnés pour l'initialisation :\n",
      "AAPL: 155.89 (Rendement: 0.00%)\n",
      "MSFT: 254.96 (Rendement: 0.00%)\n",
      "GOOGL: 109.22 (Rendement: 0.00%)\n",
      "AMZN: 127.82 (Rendement: 0.00%)\n",
      "META: 164.58 (Rendement: 0.00%)\n",
      "→ Achat de 11986 unités de AAPL @ 155.89\n",
      "→ Achat de 7328 unités de MSFT @ 254.96\n",
      "→ Achat de 17108 unités de GOOGL @ 109.22\n",
      "→ Achat de 14618 unités de AMZN @ 127.82\n",
      "→ Achat de 11353 unités de META @ 164.58\n",
      "\n",
      "Cash restant : 583.66\n",
      "✅ Portefeuille LOW_RISK initialisé avec quantité = 1 pour tous les actifs.\n"
     ]
    }
   ],
   "source": [
    "B_udt.initialisation_portefeuille_HY()\n",
    "update_portefeuille2(db_file,['BND', 'AGG', 'JNJ', 'KO', 'PG'], \"LOW_RISK\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# 4. Execution des strategies"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "Début de la simulation historique du 01/01/2023 au 31/12/2023\n",
      "\n",
      "=== Simulation pour le lundi 02/01/2023 ===\n",
      "Exécution de la stratégie pour la date historique : 02/01/2023\n",
      "Updating products for historical week: 26/12/2022 to 01/01/2023\n",
      "Successfully inserted 68 new records into Products table for the period 26/12/2022 to 01/01/2023\n",
      "Running strategies...\n",
      "Running HY_EQUITY strategy...\n",
      "→ Transaction effectuée : Sell 4259 x AMZN @ 84.00\n",
      "→ Transaction effectuée : Sell 1838 x AAPL @ 128.44\n",
      "→ Transaction effectuée : Sell 1739 x META @ 119.78\n",
      "→ Transaction effectuée : Sell 1904 x GOOGL @ 87.81\n",
      "→ Transaction effectuée : Buy 47 x MSFT @ 235.48\n",
      "Cash restant : 958,819.07\n",
      "Running Monte Carlo robust strategy for LOW_RISK...\n",
      "✅ Monte Carlo strategy executed with result:\n",
      "{'tickers': ['BND', 'AGG', 'JNJ', 'KO', 'PG'], 'quantities': {'BND': np.int64(61351), 'AGG': np.int64(16303), 'JNJ': np.int64(12002), 'KO': np.int64(5539), 'PG': np.int64(5840)}, 'volatility': np.float64(0.09461142688573046), 'expected_return': np.float64(-0.0028568044967655915), 'total_cost': np.float64(8392977.897281647), 'gain_or_loss': np.float64(390365.62046888657), 'performance': 'gain'}\n",
      "\n",
      "=== Simulation pour le lundi 09/01/2023 ===\n",
      "Exécution de la stratégie pour la date historique : 09/01/2023\n",
      "Updating products for historical week: 02/01/2023 to 08/01/2023\n",
      "Successfully inserted 68 new records into Products table for the period 02/01/2023 to 08/01/2023\n",
      "Running strategies...\n",
      "Running HY_EQUITY strategy...\n",
      "→ Transaction effectuée : Sell 3018 x AMZN @ 84.00\n",
      "→ Transaction effectuée : Sell 1556 x AAPL @ 128.44\n",
      "→ Transaction effectuée : Sell 1473 x META @ 119.78\n",
      "→ Transaction effectuée : Sell 1692 x GOOGL @ 87.81\n",
      "→ Transaction effectuée : Buy 47 x MSFT @ 235.48\n",
      "Cash restant : 1,726,115.31\n",
      "Running Monte Carlo robust strategy for LOW_RISK...\n",
      "⚠️ Aucune stratégie optimale trouvée. Portefeuille conservé.\n",
      "\n",
      "=== Simulation pour le lundi 16/01/2023 ===\n",
      "Exécution de la stratégie pour la date historique : 16/01/2023\n",
      "Updating products for historical week: 09/01/2023 to 15/01/2023\n",
      "Successfully inserted 85 new records into Products table for the period 09/01/2023 to 15/01/2023\n",
      "Running strategies...\n",
      "Running HY_EQUITY strategy...\n",
      "→ Transaction effectuée : Sell 2139 x AMZN @ 84.00\n",
      "→ Transaction effectuée : Sell 1317 x AAPL @ 128.44\n",
      "→ Transaction effectuée : Sell 1247 x META @ 119.78\n",
      "→ Transaction effectuée : Sell 1503 x GOOGL @ 87.81\n",
      "→ Transaction effectuée : Buy 48 x MSFT @ 235.48\n",
      "Cash restant : 2,344,978.32\n",
      "Running Monte Carlo robust strategy for LOW_RISK...\n",
      "⚠️ Aucune stratégie optimale trouvée. Portefeuille conservé.\n",
      "\n",
      "=== Simulation pour le lundi 23/01/2023 ===\n",
      "Exécution de la stratégie pour la date historique : 23/01/2023\n",
      "Updating products for historical week: 16/01/2023 to 22/01/2023\n",
      "Successfully inserted 68 new records into Products table for the period 16/01/2023 to 22/01/2023\n",
      "Running strategies...\n",
      "Running HY_EQUITY strategy...\n",
      "→ Transaction effectuée : Sell 1515 x AMZN @ 84.00\n",
      "→ Transaction effectuée : Sell 1115 x AAPL @ 128.44\n",
      "→ Transaction effectuée : Sell 1056 x META @ 119.78\n",
      "→ Transaction effectuée : Sell 1336 x GOOGL @ 87.81\n",
      "→ Transaction effectuée : Buy 48 x MSFT @ 235.48\n",
      "Cash restant : 2,847,939.70\n",
      "Running Monte Carlo robust strategy for LOW_RISK...\n",
      "⚠️ Aucune stratégie optimale trouvée. Portefeuille conservé.\n",
      "\n",
      "=== Simulation pour le lundi 30/01/2023 ===\n",
      "Exécution de la stratégie pour la date historique : 30/01/2023\n",
      "Updating products for historical week: 23/01/2023 to 29/01/2023\n",
      "Successfully inserted 85 new records into Products table for the period 23/01/2023 to 29/01/2023\n",
      "Running strategies...\n",
      "Running HY_EQUITY strategy...\n",
      "→ Transaction effectuée : Sell 506 x AMZN @ 102.24\n",
      "→ Transaction effectuée : Buy 395 x META @ 151.03\n",
      "→ Transaction effectuée : Sell 302 x AAPL @ 144.25\n",
      "→ Transaction effectuée : Buy 311 x MSFT @ 243.66\n",
      "→ Transaction effectuée : Buy 9 x GOOGL @ 98.90\n",
      "Cash restant : 2,806,911.58\n",
      "Running Monte Carlo robust strategy for LOW_RISK...\n",
      "⚠️ Aucune stratégie optimale trouvée. Portefeuille conservé.\n",
      "\n",
      "=== Simulation pour le lundi 06/02/2023 ===\n",
      "Exécution de la stratégie pour la date historique : 06/02/2023\n",
      "Updating products for historical week: 30/01/2023 to 05/02/2023\n",
      "Successfully inserted 85 new records into Products table for the period 30/01/2023 to 05/02/2023\n",
      "Running strategies...\n",
      "Running HY_EQUITY strategy...\n",
      "→ Transaction effectuée : Sell 413 x AMZN @ 103.13\n",
      "→ Transaction effectuée : Sell 350 x AAPL @ 142.63\n",
      "→ Transaction effectuée : Buy 300 x META @ 148.27\n",
      "→ Transaction effectuée : Buy 313 x MSFT @ 243.32\n",
      "→ Transaction effectuée : Sell 47 x GOOGL @ 98.37\n",
      "Cash restant : 2,783,407.90\n",
      "Running Monte Carlo robust strategy for LOW_RISK...\n",
      "⚠️ Aucune stratégie optimale trouvée. Portefeuille conservé.\n",
      "\n",
      "=== Simulation pour le lundi 13/02/2023 ===\n",
      "Exécution de la stratégie pour la date historique : 13/02/2023\n",
      "Updating products for historical week: 06/02/2023 to 12/02/2023\n",
      "Successfully inserted 85 new records into Products table for the period 06/02/2023 to 12/02/2023\n",
      "Running strategies...\n",
      "Running HY_EQUITY strategy...\n",
      "→ Transaction effectuée : Sell 359 x AMZN @ 103.13\n",
      "→ Transaction effectuée : Sell 329 x AAPL @ 142.63\n",
      "→ Transaction effectuée : Buy 314 x META @ 148.27\n",
      "→ Transaction effectuée : Buy 325 x MSFT @ 243.32\n",
      "→ Transaction effectuée : Sell 47 x GOOGL @ 98.37\n",
      "Cash restant : 2,746,344.28\n",
      "Running Monte Carlo robust strategy for LOW_RISK...\n",
      "⚠️ Aucune stratégie optimale trouvée. Portefeuille conservé.\n",
      "\n",
      "=== Simulation pour le lundi 20/02/2023 ===\n",
      "Exécution de la stratégie pour la date historique : 20/02/2023\n",
      "Updating products for historical week: 13/02/2023 to 19/02/2023\n",
      "Successfully inserted 85 new records into Products table for the period 13/02/2023 to 19/02/2023\n",
      "Running strategies...\n",
      "Running HY_EQUITY strategy...\n",
      "→ Transaction effectuée : Sell 313 x AMZN @ 103.13\n",
      "→ Transaction effectuée : Sell 309 x AAPL @ 142.63\n",
      "→ Transaction effectuée : Buy 330 x META @ 148.27\n",
      "→ Transaction effectuée : Buy 338 x MSFT @ 243.32\n",
      "→ Transaction effectuée : Sell 46 x GOOGL @ 98.37\n",
      "Cash restant : 2,696,050.18\n",
      "Running Monte Carlo robust strategy for LOW_RISK...\n",
      "⚠️ Aucune stratégie optimale trouvée. Portefeuille conservé.\n",
      "\n",
      "=== Simulation pour le lundi 27/02/2023 ===\n",
      "Exécution de la stratégie pour la date historique : 27/02/2023\n",
      "Updating products for historical week: 20/02/2023 to 26/02/2023\n",
      "Successfully inserted 68 new records into Products table for the period 20/02/2023 to 26/02/2023\n",
      "Running strategies...\n",
      "Running HY_EQUITY strategy...\n",
      "→ Transaction effectuée : Sell 442 x AMZN @ 93.50\n",
      "→ Transaction effectuée : Buy 1427 x META @ 169.59\n",
      "→ Transaction effectuée : Sell 1077 x GOOGL @ 88.71\n",
      "→ Transaction effectuée : Buy 427 x MSFT @ 245.32\n",
      "→ Transaction effectuée : Sell 207 x AAPL @ 145.25\n",
      "Cash restant : 2,516,222.35\n",
      "Running Monte Carlo robust strategy for LOW_RISK...\n",
      "⚠️ Aucune stratégie optimale trouvée. Portefeuille conservé.\n",
      "\n",
      "=== Simulation pour le lundi 06/03/2023 ===\n",
      "Exécution de la stratégie pour la date historique : 06/03/2023\n",
      "Updating products for historical week: 27/02/2023 to 05/03/2023\n",
      "Successfully inserted 85 new records into Products table for the period 27/02/2023 to 05/03/2023\n",
      "Running strategies...\n",
      "Running HY_EQUITY strategy...\n",
      "→ Transaction effectuée : Buy 1986 x META @ 174.12\n",
      "→ Transaction effectuée : Sell 339 x AMZN @ 94.23\n",
      "→ Transaction effectuée : Sell 879 x GOOGL @ 89.63\n",
      "→ Transaction effectuée : Buy 455 x MSFT @ 245.52\n",
      "→ Transaction effectuée : Sell 177 x AAPL @ 145.94\n",
      "Cash restant : 2,195,272.97\n",
      "Running Monte Carlo robust strategy for LOW_RISK...\n",
      "⚠️ Aucune stratégie optimale trouvée. Portefeuille conservé.\n",
      "\n",
      "=== Simulation pour le lundi 13/03/2023 ===\n",
      "Exécution de la stratégie pour la date historique : 13/03/2023\n",
      "Updating products for historical week: 06/03/2023 to 12/03/2023\n",
      "Successfully inserted 85 new records into Products table for the period 06/03/2023 to 12/03/2023\n",
      "Running strategies...\n",
      "Running HY_EQUITY strategy...\n",
      "→ Transaction effectuée : Buy 2445 x META @ 174.12\n",
      "→ Transaction effectuée : Sell 269 x AMZN @ 94.23\n",
      "→ Transaction effectuée : Sell 797 x GOOGL @ 89.63\n",
      "→ Transaction effectuée : Buy 478 x MSFT @ 245.52\n",
      "→ Transaction effectuée : Sell 170 x AAPL @ 145.94\n",
      "Cash restant : 1,773,788.49\n",
      "Running Monte Carlo robust strategy for LOW_RISK...\n",
      "⚠️ Aucune stratégie optimale trouvée. Portefeuille conservé.\n",
      "\n",
      "=== Simulation pour le lundi 20/03/2023 ===\n",
      "Exécution de la stratégie pour la date historique : 20/03/2023\n",
      "Updating products for historical week: 13/03/2023 to 19/03/2023\n",
      "Successfully inserted 85 new records into Products table for the period 13/03/2023 to 19/03/2023\n",
      "Running strategies...\n",
      "Running HY_EQUITY strategy...\n",
      "→ Transaction effectuée : Buy 3010 x META @ 174.12\n",
      "→ Transaction effectuée : Sell 214 x AMZN @ 94.23\n",
      "→ Transaction effectuée : Sell 723 x GOOGL @ 89.63\n",
      "→ Transaction effectuée : Buy 501 x MSFT @ 245.52\n",
      "→ Transaction effectuée : Sell 163 x AAPL @ 145.94\n",
      "Cash restant : 1,235,442.77\n",
      "Running Monte Carlo robust strategy for LOW_RISK...\n",
      "⚠️ Aucune stratégie optimale trouvée. Portefeuille conservé.\n",
      "\n",
      "=== Simulation pour le lundi 27/03/2023 ===\n",
      "Exécution de la stratégie pour la date historique : 27/03/2023\n",
      "Updating products for historical week: 20/03/2023 to 26/03/2023\n",
      "Successfully inserted 85 new records into Products table for the period 20/03/2023 to 26/03/2023\n",
      "Running strategies...\n",
      "Running HY_EQUITY strategy...\n",
      "→ Transaction effectuée : Buy 6025 x META @ 205.04\n",
      "→ Transaction effectuée : Sell 143 x AMZN @ 98.13\n",
      "→ Transaction effectuée : Buy 134 x GOOGL @ 104.94\n",
      "Cash restant : 25.88\n",
      "Running Monte Carlo robust strategy for LOW_RISK...\n",
      "⚠️ Aucune stratégie optimale trouvée. Portefeuille conservé.\n",
      "\n",
      "=== Simulation pour le lundi 03/04/2023 ===\n",
      "Exécution de la stratégie pour la date historique : 03/04/2023\n",
      "Updating products for historical week: 27/03/2023 to 02/04/2023\n",
      "Successfully inserted 85 new records into Products table for the period 27/03/2023 to 02/04/2023\n",
      "Running strategies...\n",
      "Running HY_EQUITY strategy...\n",
      "→ Transaction effectuée : Sell 88 x AMZN @ 103.29\n",
      "→ Transaction effectuée : Buy 55 x AAPL @ 163.25\n",
      "→ Transaction effectuée : Buy 1 x GOOGL @ 103.24\n",
      "Cash restant : 33.21\n",
      "Running Monte Carlo robust strategy for LOW_RISK...\n",
      "⚠️ Aucune stratégie optimale trouvée. Portefeuille conservé.\n",
      "\n",
      "=== Simulation pour le lundi 10/04/2023 ===\n",
      "Exécution de la stratégie pour la date historique : 10/04/2023\n",
      "Updating products for historical week: 03/04/2023 to 09/04/2023\n",
      "Successfully inserted 68 new records into Products table for the period 03/04/2023 to 09/04/2023\n",
      "Running strategies...\n",
      "Running HY_EQUITY strategy...\n",
      "→ Transaction effectuée : Sell 77 x AMZN @ 103.29\n",
      "→ Transaction effectuée : Buy 48 x AAPL @ 163.25\n",
      "→ Transaction effectuée : Buy 1 x GOOGL @ 103.24\n",
      "Cash restant : 47.13\n",
      "Running Monte Carlo robust strategy for LOW_RISK...\n",
      "⚠️ Aucune stratégie optimale trouvée. Portefeuille conservé.\n",
      "\n",
      "=== Simulation pour le lundi 17/04/2023 ===\n",
      "Exécution de la stratégie pour la date historique : 17/04/2023\n",
      "Updating products for historical week: 10/04/2023 to 16/04/2023\n",
      "Successfully inserted 85 new records into Products table for the period 10/04/2023 to 16/04/2023\n",
      "Running strategies...\n",
      "Running HY_EQUITY strategy...\n",
      "→ Transaction effectuée : Sell 67 x AMZN @ 103.29\n",
      "→ Transaction effectuée : Buy 42 x AAPL @ 163.25\n",
      "→ Transaction effectuée : Buy 1 x GOOGL @ 103.24\n",
      "Cash restant : 7.67\n",
      "Running Monte Carlo robust strategy for LOW_RISK...\n",
      "⚠️ Aucune stratégie optimale trouvée. Portefeuille conservé.\n",
      "\n",
      "=== Simulation pour le lundi 24/04/2023 ===\n",
      "Exécution de la stratégie pour la date historique : 24/04/2023\n",
      "Updating products for historical week: 17/04/2023 to 23/04/2023\n",
      "Successfully inserted 85 new records into Products table for the period 17/04/2023 to 23/04/2023\n",
      "Running strategies...\n",
      "Running HY_EQUITY strategy...\n",
      "→ Transaction effectuée : Sell 44 x AMZN @ 106.96\n",
      "→ Transaction effectuée : Buy 28 x AAPL @ 163.37\n",
      "→ Transaction effectuée : Buy 1 x GOOGL @ 104.91\n",
      "Cash restant : 34.58\n",
      "Running Monte Carlo robust strategy for LOW_RISK...\n",
      "⚠️ Aucune stratégie optimale trouvée. Portefeuille conservé.\n",
      "\n",
      "=== Simulation pour le lundi 01/05/2023 ===\n",
      "Exécution de la stratégie pour la date historique : 01/05/2023\n",
      "Updating products for historical week: 24/04/2023 to 30/04/2023\n",
      "Successfully inserted 85 new records into Products table for the period 24/04/2023 to 30/04/2023\n",
      "Running strategies...\n",
      "Running HY_EQUITY strategy...\n",
      "→ Transaction effectuée : Sell 45 x AMZN @ 105.45\n",
      "→ Transaction effectuée : Buy 28 x AAPL @ 167.99\n",
      "Cash restant : 76.22\n",
      "Running Monte Carlo robust strategy for LOW_RISK...\n",
      "⚠️ Aucune stratégie optimale trouvée. Portefeuille conservé.\n",
      "\n",
      "=== Simulation pour le lundi 08/05/2023 ===\n",
      "Exécution de la stratégie pour la date historique : 08/05/2023\n",
      "Updating products for historical week: 01/05/2023 to 07/05/2023\n",
      "Successfully inserted 85 new records into Products table for the period 01/05/2023 to 07/05/2023\n",
      "Running strategies...\n",
      "Running HY_EQUITY strategy...\n",
      "→ Transaction effectuée : Sell 40 x AMZN @ 105.45\n",
      "→ Transaction effectuée : Buy 25 x AAPL @ 167.99\n",
      "Cash restant : 94.57\n",
      "Running Monte Carlo robust strategy for LOW_RISK...\n",
      "⚠️ Aucune stratégie optimale trouvée. Portefeuille conservé.\n",
      "\n",
      "=== Simulation pour le lundi 15/05/2023 ===\n",
      "Exécution de la stratégie pour la date historique : 15/05/2023\n",
      "Updating products for historical week: 08/05/2023 to 14/05/2023\n",
      "Successfully inserted 85 new records into Products table for the period 08/05/2023 to 14/05/2023\n",
      "Running strategies...\n",
      "Running HY_EQUITY strategy...\n",
      "→ Transaction effectuée : Sell 36 x AMZN @ 105.45\n",
      "→ Transaction effectuée : Buy 23 x AAPL @ 167.99\n",
      "Cash restant : 27.10\n",
      "Running Monte Carlo robust strategy for LOW_RISK...\n",
      "⚠️ Aucune stratégie optimale trouvée. Portefeuille conservé.\n",
      "\n",
      "=== Simulation pour le lundi 22/05/2023 ===\n",
      "Exécution de la stratégie pour la date historique : 22/05/2023\n",
      "Updating products for historical week: 15/05/2023 to 21/05/2023\n",
      "Successfully inserted 85 new records into Products table for the period 15/05/2023 to 21/05/2023\n",
      "Running strategies...\n",
      "Running HY_EQUITY strategy...\n",
      "→ Transaction effectuée : Sell 32 x AMZN @ 105.45\n",
      "→ Transaction effectuée : Buy 20 x AAPL @ 167.99\n",
      "Cash restant : 41.78\n",
      "Running Monte Carlo robust strategy for LOW_RISK...\n",
      "⚠️ Aucune stratégie optimale trouvée. Portefeuille conservé.\n",
      "\n",
      "=== Simulation pour le lundi 29/05/2023 ===\n",
      "Exécution de la stratégie pour la date historique : 29/05/2023\n",
      "Updating products for historical week: 22/05/2023 to 28/05/2023\n",
      "Successfully inserted 85 new records into Products table for the period 22/05/2023 to 28/05/2023\n",
      "Running strategies...\n",
      "Running HY_EQUITY strategy...\n",
      "Cash restant : 41.78\n",
      "Running Monte Carlo robust strategy for LOW_RISK...\n",
      "⚠️ Aucune stratégie optimale trouvée. Portefeuille conservé.\n",
      "\n",
      "=== Simulation pour le lundi 05/06/2023 ===\n",
      "Exécution de la stratégie pour la date historique : 05/06/2023\n",
      "Updating products for historical week: 29/05/2023 to 04/06/2023\n",
      "Successfully inserted 68 new records into Products table for the period 29/05/2023 to 04/06/2023\n",
      "Running strategies...\n",
      "Running HY_EQUITY strategy...\n",
      "Cash restant : 41.78\n",
      "Running Monte Carlo robust strategy for LOW_RISK...\n",
      "⚠️ Aucune stratégie optimale trouvée. Portefeuille conservé.\n",
      "\n",
      "=== Simulation pour le lundi 12/06/2023 ===\n",
      "Exécution de la stratégie pour la date historique : 12/06/2023\n",
      "Updating products for historical week: 05/06/2023 to 11/06/2023\n",
      "Successfully inserted 85 new records into Products table for the period 05/06/2023 to 11/06/2023\n",
      "Running strategies...\n",
      "Running HY_EQUITY strategy...\n",
      "Cash restant : 41.78\n",
      "Running Monte Carlo robust strategy for LOW_RISK...\n",
      "⚠️ Aucune stratégie optimale trouvée. Portefeuille conservé.\n",
      "\n",
      "=== Simulation pour le lundi 19/06/2023 ===\n",
      "Exécution de la stratégie pour la date historique : 19/06/2023\n",
      "Updating products for historical week: 12/06/2023 to 18/06/2023\n",
      "Successfully inserted 85 new records into Products table for the period 12/06/2023 to 18/06/2023\n",
      "Running strategies...\n",
      "Running HY_EQUITY strategy...\n",
      "Cash restant : 41.78\n",
      "Running Monte Carlo robust strategy for LOW_RISK...\n",
      "⚠️ Aucune stratégie optimale trouvée. Portefeuille conservé.\n",
      "\n",
      "=== Simulation pour le lundi 26/06/2023 ===\n",
      "Exécution de la stratégie pour la date historique : 26/06/2023\n",
      "Updating products for historical week: 19/06/2023 to 25/06/2023\n",
      "Successfully inserted 68 new records into Products table for the period 19/06/2023 to 25/06/2023\n",
      "Running strategies...\n",
      "Running HY_EQUITY strategy...\n",
      "Cash restant : 41.78\n",
      "Running Monte Carlo robust strategy for LOW_RISK...\n",
      "⚠️ Aucune stratégie optimale trouvée. Portefeuille conservé.\n",
      "\n",
      "=== Simulation pour le lundi 03/07/2023 ===\n",
      "Exécution de la stratégie pour la date historique : 03/07/2023\n",
      "Updating products for historical week: 26/06/2023 to 02/07/2023\n",
      "Successfully inserted 85 new records into Products table for the period 26/06/2023 to 02/07/2023\n",
      "Running strategies...\n",
      "Running HY_EQUITY strategy...\n",
      "Cash restant : 41.78\n",
      "Running Monte Carlo robust strategy for LOW_RISK...\n",
      "⚠️ Aucune stratégie optimale trouvée. Portefeuille conservé.\n",
      "\n",
      "=== Simulation pour le lundi 10/07/2023 ===\n",
      "Exécution de la stratégie pour la date historique : 10/07/2023\n",
      "Updating products for historical week: 03/07/2023 to 09/07/2023\n",
      "Successfully inserted 68 new records into Products table for the period 03/07/2023 to 09/07/2023\n",
      "Running strategies...\n",
      "Running HY_EQUITY strategy...\n",
      "Cash restant : 41.78\n",
      "Running Monte Carlo robust strategy for LOW_RISK...\n",
      "⚠️ Aucune stratégie optimale trouvée. Portefeuille conservé.\n",
      "\n",
      "=== Simulation pour le lundi 17/07/2023 ===\n",
      "Exécution de la stratégie pour la date historique : 17/07/2023\n",
      "Updating products for historical week: 10/07/2023 to 16/07/2023\n",
      "Successfully inserted 85 new records into Products table for the period 10/07/2023 to 16/07/2023\n",
      "Running strategies...\n",
      "Running HY_EQUITY strategy...\n",
      "Cash restant : 41.78\n",
      "Running Monte Carlo robust strategy for LOW_RISK...\n",
      "⚠️ Aucune stratégie optimale trouvée. Portefeuille conservé.\n",
      "\n",
      "=== Simulation pour le lundi 24/07/2023 ===\n",
      "Exécution de la stratégie pour la date historique : 24/07/2023\n",
      "Updating products for historical week: 17/07/2023 to 23/07/2023\n",
      "Successfully inserted 85 new records into Products table for the period 17/07/2023 to 23/07/2023\n",
      "Running strategies...\n",
      "Running HY_EQUITY strategy...\n",
      "Cash restant : 41.78\n",
      "Running Monte Carlo robust strategy for LOW_RISK...\n",
      "⚠️ Aucune stratégie optimale trouvée. Portefeuille conservé.\n",
      "\n",
      "=== Simulation pour le lundi 31/07/2023 ===\n",
      "Exécution de la stratégie pour la date historique : 31/07/2023\n",
      "Updating products for historical week: 24/07/2023 to 30/07/2023\n",
      "Successfully inserted 85 new records into Products table for the period 24/07/2023 to 30/07/2023\n",
      "Running strategies...\n",
      "Running HY_EQUITY strategy...\n",
      "Cash restant : 41.78\n",
      "Running Monte Carlo robust strategy for LOW_RISK...\n",
      "⚠️ Aucune stratégie optimale trouvée. Portefeuille conservé.\n",
      "\n",
      "=== Simulation pour le lundi 07/08/2023 ===\n",
      "Exécution de la stratégie pour la date historique : 07/08/2023\n",
      "Updating products for historical week: 31/07/2023 to 06/08/2023\n",
      "Successfully inserted 85 new records into Products table for the period 31/07/2023 to 06/08/2023\n",
      "Running strategies...\n",
      "Running HY_EQUITY strategy...\n",
      "Cash restant : 41.78\n",
      "Running Monte Carlo robust strategy for LOW_RISK...\n",
      "⚠️ Aucune stratégie optimale trouvée. Portefeuille conservé.\n",
      "\n",
      "=== Simulation pour le lundi 14/08/2023 ===\n",
      "Exécution de la stratégie pour la date historique : 14/08/2023\n",
      "Updating products for historical week: 07/08/2023 to 13/08/2023\n",
      "Successfully inserted 85 new records into Products table for the period 07/08/2023 to 13/08/2023\n",
      "Running strategies...\n",
      "Running HY_EQUITY strategy...\n",
      "Cash restant : 41.78\n",
      "Running Monte Carlo robust strategy for LOW_RISK...\n",
      "⚠️ Aucune stratégie optimale trouvée. Portefeuille conservé.\n",
      "\n",
      "=== Simulation pour le lundi 21/08/2023 ===\n",
      "Exécution de la stratégie pour la date historique : 21/08/2023\n",
      "Updating products for historical week: 14/08/2023 to 20/08/2023\n",
      "Successfully inserted 85 new records into Products table for the period 14/08/2023 to 20/08/2023\n",
      "Running strategies...\n",
      "Running HY_EQUITY strategy...\n",
      "Cash restant : 41.78\n",
      "Running Monte Carlo robust strategy for LOW_RISK...\n",
      "⚠️ Aucune stratégie optimale trouvée. Portefeuille conservé.\n",
      "\n",
      "=== Simulation pour le lundi 28/08/2023 ===\n",
      "Exécution de la stratégie pour la date historique : 28/08/2023\n",
      "Updating products for historical week: 21/08/2023 to 27/08/2023\n",
      "Successfully inserted 85 new records into Products table for the period 21/08/2023 to 27/08/2023\n",
      "Running strategies...\n",
      "Running HY_EQUITY strategy...\n",
      "Cash restant : 41.78\n",
      "Running Monte Carlo robust strategy for LOW_RISK...\n",
      "⚠️ Aucune stratégie optimale trouvée. Portefeuille conservé.\n",
      "\n",
      "=== Simulation pour le lundi 04/09/2023 ===\n",
      "Exécution de la stratégie pour la date historique : 04/09/2023\n",
      "Updating products for historical week: 28/08/2023 to 03/09/2023\n",
      "Successfully inserted 85 new records into Products table for the period 28/08/2023 to 03/09/2023\n",
      "Running strategies...\n",
      "Running HY_EQUITY strategy...\n",
      "Cash restant : 41.78\n",
      "Running Monte Carlo robust strategy for LOW_RISK...\n",
      "⚠️ Aucune stratégie optimale trouvée. Portefeuille conservé.\n",
      "\n",
      "=== Simulation pour le lundi 11/09/2023 ===\n",
      "Exécution de la stratégie pour la date historique : 11/09/2023\n",
      "Updating products for historical week: 04/09/2023 to 10/09/2023\n",
      "Successfully inserted 68 new records into Products table for the period 04/09/2023 to 10/09/2023\n",
      "Running strategies...\n",
      "Running HY_EQUITY strategy...\n",
      "Cash restant : 41.78\n",
      "Running Monte Carlo robust strategy for LOW_RISK...\n",
      "⚠️ Aucune stratégie optimale trouvée. Portefeuille conservé.\n",
      "\n",
      "=== Simulation pour le lundi 18/09/2023 ===\n",
      "Exécution de la stratégie pour la date historique : 18/09/2023\n",
      "Updating products for historical week: 11/09/2023 to 17/09/2023\n",
      "Successfully inserted 85 new records into Products table for the period 11/09/2023 to 17/09/2023\n",
      "Running strategies...\n",
      "Running HY_EQUITY strategy...\n",
      "Cash restant : 41.78\n",
      "Running Monte Carlo robust strategy for LOW_RISK...\n",
      "⚠️ Aucune stratégie optimale trouvée. Portefeuille conservé.\n",
      "\n",
      "=== Simulation pour le lundi 25/09/2023 ===\n",
      "Exécution de la stratégie pour la date historique : 25/09/2023\n",
      "Updating products for historical week: 18/09/2023 to 24/09/2023\n",
      "Successfully inserted 85 new records into Products table for the period 18/09/2023 to 24/09/2023\n",
      "Running strategies...\n",
      "Running HY_EQUITY strategy...\n",
      "Cash restant : 41.78\n",
      "Running Monte Carlo robust strategy for LOW_RISK...\n",
      "⚠️ Aucune stratégie optimale trouvée. Portefeuille conservé.\n",
      "\n",
      "=== Simulation pour le lundi 02/10/2023 ===\n",
      "Exécution de la stratégie pour la date historique : 02/10/2023\n",
      "Updating products for historical week: 25/09/2023 to 01/10/2023\n",
      "Successfully inserted 85 new records into Products table for the period 25/09/2023 to 01/10/2023\n",
      "Running strategies...\n",
      "Running HY_EQUITY strategy...\n",
      "Cash restant : 41.78\n",
      "Running Monte Carlo robust strategy for LOW_RISK...\n",
      "⚠️ Aucune stratégie optimale trouvée. Portefeuille conservé.\n",
      "\n",
      "=== Simulation pour le lundi 09/10/2023 ===\n",
      "Exécution de la stratégie pour la date historique : 09/10/2023\n",
      "Updating products for historical week: 02/10/2023 to 08/10/2023\n",
      "Successfully inserted 85 new records into Products table for the period 02/10/2023 to 08/10/2023\n",
      "Running strategies...\n",
      "Running HY_EQUITY strategy...\n",
      "Cash restant : 41.78\n",
      "Running Monte Carlo robust strategy for LOW_RISK...\n",
      "⚠️ Aucune stratégie optimale trouvée. Portefeuille conservé.\n",
      "\n",
      "=== Simulation pour le lundi 16/10/2023 ===\n",
      "Exécution de la stratégie pour la date historique : 16/10/2023\n",
      "Updating products for historical week: 09/10/2023 to 15/10/2023\n",
      "Successfully inserted 85 new records into Products table for the period 09/10/2023 to 15/10/2023\n",
      "Running strategies...\n",
      "Running HY_EQUITY strategy...\n",
      "Cash restant : 41.78\n",
      "Running Monte Carlo robust strategy for LOW_RISK...\n",
      "⚠️ Aucune stratégie optimale trouvée. Portefeuille conservé.\n",
      "\n",
      "=== Simulation pour le lundi 23/10/2023 ===\n",
      "Exécution de la stratégie pour la date historique : 23/10/2023\n",
      "Updating products for historical week: 16/10/2023 to 22/10/2023\n",
      "Successfully inserted 85 new records into Products table for the period 16/10/2023 to 22/10/2023\n",
      "Running strategies...\n",
      "Running HY_EQUITY strategy...\n",
      "Cash restant : 41.78\n",
      "Running Monte Carlo robust strategy for LOW_RISK...\n",
      "⚠️ Aucune stratégie optimale trouvée. Portefeuille conservé.\n",
      "\n",
      "=== Simulation pour le lundi 30/10/2023 ===\n",
      "Exécution de la stratégie pour la date historique : 30/10/2023\n",
      "Updating products for historical week: 23/10/2023 to 29/10/2023\n",
      "Successfully inserted 85 new records into Products table for the period 23/10/2023 to 29/10/2023\n",
      "Running strategies...\n",
      "Running HY_EQUITY strategy...\n",
      "Cash restant : 41.78\n",
      "Running Monte Carlo robust strategy for LOW_RISK...\n",
      "⚠️ Aucune stratégie optimale trouvée. Portefeuille conservé.\n",
      "\n",
      "=== Simulation pour le lundi 06/11/2023 ===\n",
      "Exécution de la stratégie pour la date historique : 06/11/2023\n",
      "Updating products for historical week: 30/10/2023 to 05/11/2023\n",
      "Successfully inserted 85 new records into Products table for the period 30/10/2023 to 05/11/2023\n",
      "Running strategies...\n",
      "Running HY_EQUITY strategy...\n",
      "Cash restant : 41.78\n",
      "Running Monte Carlo robust strategy for LOW_RISK...\n",
      "⚠️ Aucune stratégie optimale trouvée. Portefeuille conservé.\n",
      "\n",
      "=== Simulation pour le lundi 13/11/2023 ===\n",
      "Exécution de la stratégie pour la date historique : 13/11/2023\n",
      "Updating products for historical week: 06/11/2023 to 12/11/2023\n",
      "Successfully inserted 85 new records into Products table for the period 06/11/2023 to 12/11/2023\n",
      "Running strategies...\n",
      "Running HY_EQUITY strategy...\n",
      "Cash restant : 41.78\n",
      "Running Monte Carlo robust strategy for LOW_RISK...\n",
      "⚠️ Aucune stratégie optimale trouvée. Portefeuille conservé.\n",
      "\n",
      "=== Simulation pour le lundi 20/11/2023 ===\n",
      "Exécution de la stratégie pour la date historique : 20/11/2023\n",
      "Updating products for historical week: 13/11/2023 to 19/11/2023\n",
      "Successfully inserted 85 new records into Products table for the period 13/11/2023 to 19/11/2023\n",
      "Running strategies...\n",
      "Running HY_EQUITY strategy...\n",
      "Cash restant : 41.78\n",
      "Running Monte Carlo robust strategy for LOW_RISK...\n",
      "⚠️ Aucune stratégie optimale trouvée. Portefeuille conservé.\n",
      "\n",
      "=== Simulation pour le lundi 27/11/2023 ===\n",
      "Exécution de la stratégie pour la date historique : 27/11/2023\n",
      "Updating products for historical week: 20/11/2023 to 26/11/2023\n",
      "Successfully inserted 68 new records into Products table for the period 20/11/2023 to 26/11/2023\n",
      "Running strategies...\n",
      "Running HY_EQUITY strategy...\n",
      "Cash restant : 41.78\n",
      "Running Monte Carlo robust strategy for LOW_RISK...\n",
      "⚠️ Aucune stratégie optimale trouvée. Portefeuille conservé.\n",
      "\n",
      "=== Simulation pour le lundi 04/12/2023 ===\n",
      "Exécution de la stratégie pour la date historique : 04/12/2023\n",
      "Updating products for historical week: 27/11/2023 to 03/12/2023\n",
      "Successfully inserted 85 new records into Products table for the period 27/11/2023 to 03/12/2023\n",
      "Running strategies...\n",
      "Running HY_EQUITY strategy...\n",
      "Cash restant : 41.78\n",
      "Running Monte Carlo robust strategy for LOW_RISK...\n",
      "⚠️ Aucune stratégie optimale trouvée. Portefeuille conservé.\n",
      "\n",
      "=== Simulation pour le lundi 11/12/2023 ===\n",
      "Exécution de la stratégie pour la date historique : 11/12/2023\n",
      "Updating products for historical week: 04/12/2023 to 10/12/2023\n",
      "Successfully inserted 85 new records into Products table for the period 04/12/2023 to 10/12/2023\n",
      "Running strategies...\n",
      "Running HY_EQUITY strategy...\n",
      "Cash restant : 41.78\n",
      "Running Monte Carlo robust strategy for LOW_RISK...\n",
      "⚠️ Aucune stratégie optimale trouvée. Portefeuille conservé.\n",
      "\n",
      "=== Simulation pour le lundi 18/12/2023 ===\n",
      "Exécution de la stratégie pour la date historique : 18/12/2023\n",
      "Updating products for historical week: 11/12/2023 to 17/12/2023\n",
      "Successfully inserted 85 new records into Products table for the period 11/12/2023 to 17/12/2023\n",
      "Running strategies...\n",
      "Running HY_EQUITY strategy...\n",
      "Cash restant : 41.78\n",
      "Running Monte Carlo robust strategy for LOW_RISK...\n",
      "⚠️ Aucune stratégie optimale trouvée. Portefeuille conservé.\n",
      "\n",
      "=== Simulation pour le lundi 25/12/2023 ===\n",
      "Exécution de la stratégie pour la date historique : 25/12/2023\n",
      "Updating products for historical week: 18/12/2023 to 24/12/2023\n",
      "Successfully inserted 85 new records into Products table for the period 18/12/2023 to 24/12/2023\n",
      "Running strategies...\n",
      "Running HY_EQUITY strategy...\n",
      "Cash restant : 41.78\n",
      "Running Monte Carlo robust strategy for LOW_RISK...\n",
      "⚠️ Aucune stratégie optimale trouvée. Portefeuille conservé.\n",
      "\n",
      "Simulation terminée !\n",
      "Nombre de lundis simulés : 52\n",
      "Période couverte : 01/01/2023 au 31/12/2023\n"
     ]
    }
   ],
   "source": [
    "from strategies import RunAllStrat\n",
    "start_date2=\"01/01/2023\"\n",
    "end_date2=\"31/12/2023\"\n",
    "b=RunAllStrat(db_file,start_date2,end_date2,tickers, main_df)\n",
    "b.run()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Reconstruction de la composition des portefeuilles"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "db_manager.rebuild_portfolio_history_by_risk_type(\"HY_EQUITY\")\n",
    "db_manager.rebuild_portfolio_history_by_risk_type(\"LOW_EQUITY\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Visualisation des performances des portefeuilles"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "from Performance import PortfolioAnalyzer"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "analyzer = PortfolioAnalyzer(\"Fund.db\")\n",
    "analyzer.plot_portfolio_performance()\n",
    "metrics_df = analyzer.compute_portfolio_metrics()\n",
    "print(metrics_df)\n",
    "analyzer.describe_best_portfolios()"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.12.1"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
